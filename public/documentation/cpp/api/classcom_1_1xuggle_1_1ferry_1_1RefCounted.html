<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Xuggle: com::xuggle::ferry::RefCounted Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacecom.html">com</a>::<a class="el" href="namespacecom_1_1xuggle.html">xuggle</a>::<a class="el" href="namespacecom_1_1xuggle_1_1ferry.html">ferry</a>::<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a>
  </div>
</div>
<div class="contents">
<h1>com::xuggle::ferry::RefCounted Class Reference</h1><!-- doxytag: class="com::xuggle::ferry::RefCounted" --><code>#include &lt;<a class="el" href="RefCounted_8h-source.html">RefCounted.h</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for com::xuggle::ferry::RefCounted:</div>
<div class="dynsection">
<p><center><img src="classcom_1_1xuggle_1_1ferry_1_1RefCounted__inherit__graph.png" border="0" usemap="#com_1_1xuggle_1_1ferry_1_1RefCounted__inherit__map" alt="Inheritance graph"></center>
<map name="com_1_1xuggle_1_1ferry_1_1RefCounted__inherit__map">
<area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html" title="Allows Java code to get data from a native buffers, and optionally modify native..." alt="" coords="328,6,512,32"><area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1Mutex.html" title="Internal Only." alt="" coords="329,56,511,83"><area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1RefCountedTester.html" title="Internal Only." alt="" coords="293,107,547,134"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Global.html" title="A collection of static functions that refer to the entire package (like version getters)..." alt="" coords="319,158,521,184"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IAudioResampler.html" title="Used to resample IAudioSamples to different sample rates or number of channels." alt="" coords="287,208,553,235"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1ICodec.html" title="A &quot;key&quot; to an IStreamCoder that tells it how to encode or decode data." alt="" coords="317,259,523,286"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IContainer.html" title="A file (or network data source) that contains one or more IStream objects of audio..." alt="" coords="307,310,533,336"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IContainerFormat.html" title="Specifies format information than can be used to configure an IContainer for input..." alt="" coords="284,360,556,387"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IContainerParameters.html" title="Parameters that can be set on a IContainer before opening." alt="" coords="269,411,571,438"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IError.html" title="Maps from int return codes to defined Error values." alt="" coords="323,462,517,488"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IIndexEntry.html" title="An index entry for a IStream." alt="" coords="304,512,536,539"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IMediaData.html" title="The parent class of all media objects than can be gotten from an IStream." alt="" coords="303,563,537,590"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IMetaData.html" title="Get MetaData about a IContainer or IStream." alt="" coords="307,614,533,640"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IPixelFormat.html" title="Information about how video data is formatted in an IVideoPicture object." alt="" coords="300,664,540,691"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IProperty.html" title="Represents settable properties that effect how Xuggler objects operate." alt="" coords="311,716,529,743"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IRational.html" title="This class wraps represents a Rational number for the Xuggler." alt="" coords="312,768,528,795"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IStream.html" title="Represents a stream of similar data (eg video) in a IContainer." alt="" coords="313,822,527,848"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IStreamCoder.html" title="The work horse of the Xuggler: Takes IPacket data from an IContainer (representing..." alt="" coords="295,879,545,906"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1ITimeValue.html" title="Time (duration) values with units." alt="" coords="304,942,536,968"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IVideoResampler.html" title="Converts IVideoPicture objects of a given width, height and format to a new width..." alt="" coords="287,1018,553,1044"><area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html" title="com::xuggle::ferry::Buffer" alt="" coords="677,6,859,32"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1AudioResampler.html" title="com::xuggle::xuggler::AudioResampler" alt="" coords="636,107,900,134"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Codec.html" title="com::xuggle::xuggler::Codec" alt="" coords="667,158,869,184"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Container.html" title="com::xuggle::xuggler::Container" alt="" coords="656,208,880,235"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1ContainerFormat.html" title="com::xuggle::xuggler::ContainerFormat" alt="" coords="633,259,903,286"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1ContainerParameters.html" title="com::xuggle::xuggler::ContainerParameters" alt="" coords="619,310,917,336"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Error.html" title="com::xuggle::xuggler::Error" alt="" coords="672,360,864,387"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IndexEntry.html" title="com::xuggle::xuggler::IndexEntry" alt="" coords="653,411,883,438"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IAudioSamples.html" title="A set of raw (decoded) samples, plus a timestamp for when to play those samples relative..." alt="" coords="640,462,896,488"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IMediaDataWrapper.html" title="This class wraps an IMediaData object, but then allows you to set new TimeStamps..." alt="" coords="625,512,911,539"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IPacket.html" title="Represents an encoded piece of data that can be placed in an IContainer for a given..." alt="" coords="664,563,872,590"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1IVideoPicture.html" title="Represents one raw (undecoded) picture in a video stream, plus a timestamp for when..." alt="" coords="645,614,891,640"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1AudioSamples.html" title="com::xuggle::xuggler::AudioSamples" alt="" coords="981,462,1235,488"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1MediaDataWrapper.html" title="com::xuggle::xuggler::MediaDataWrapper" alt="" coords="967,512,1249,539"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Packet.html" title="com::xuggle::xuggler::Packet" alt="" coords="1007,563,1209,590"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1VideoPicture.html" title="com::xuggle::xuggler::VideoPicture" alt="" coords="987,614,1229,640"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1MetaData.html" title="com::xuggle::xuggler::MetaData" alt="" coords="656,664,880,691"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1PixelFormat.html" title="com::xuggle::xuggler::PixelFormat" alt="" coords="649,715,887,742"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Property.html" title="A wrapper for an FFMPEG AVOption value." alt="" coords="660,766,876,792"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Rational.html" title="com::xuggle::xuggler::Rational" alt="" coords="661,816,875,843"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1Stream.html" title="com::xuggle::xuggler::Stream" alt="" coords="663,867,873,894"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1StreamCoder.html" title="com::xuggle::xuggler::StreamCoder" alt="" coords="644,918,892,944"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1TimeValue.html" title="com::xuggle::xuggler::TimeValue" alt="" coords="655,968,881,995"><area shape="rect" href="classcom_1_1xuggle_1_1xuggler_1_1VideoResampler.html" title="com::xuggle::xuggler::VideoResampler" alt="" coords="636,1019,900,1046"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for com::xuggle::ferry::RefCounted:</div>
<div class="dynsection">
<p><center><img src="classcom_1_1xuggle_1_1ferry_1_1RefCounted__coll__graph.png" border="0" usemap="#com_1_1xuggle_1_1ferry_1_1RefCounted__coll__map" alt="Collaboration graph"></center>
<map name="com_1_1xuggle_1_1ferry_1_1RefCounted__coll__map">
<area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1AtomicInteger.html" title="Internal only." alt="" coords="5,6,237,33"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classcom_1_1xuggle_1_1ferry_1_1RefCounted-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Parent of all Ferry objects -- it mains reference counts in native code. 
<p>
<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> objects cannot be made with new. They must be constructed with special factory methods, usually called make(...).  <h2>Special note for developers in languages other than C++</h2>
<p>
You should not need to worry about this class very much. Feel free to ignore it.  <h2>Special note for C++ Users</h2>
<p>
Users of <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> objects in Native (C++) code must make sure they <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#395308babb5ac6d276e138c694d1535c" title="Internal Only.">acquire()</a> a reference to an object if they intend to keep using it after they have returned from the method it was passed to, and must call <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#2b9f941c8693c281e8683bca97704e4d" title="Internal Only.">release()</a> when done to ensure memory is freed.  <p>
Methods that return <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> objects on the stack are expected to <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#395308babb5ac6d276e138c694d1535c" title="Internal Only.">acquire()</a> the reference for the caller, and callers <b>must</b> <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#2b9f941c8693c281e8683bca97704e4d" title="Internal Only.">release()</a> any <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> object returned on the stack. <p>
For example:  <code> <pre>
 <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> * methodReturningRefCountedObject();
 {
   mValueToReturn-&gt;<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#395308babb5ac6d276e138c694d1535c" title="Internal Only.">acquire()</a>; // acquire for caller
   return mValueToReturn; // and return
 }</pre></code><p>
<code><pre> {
   <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> *value = methodReturningRefCountedObject();
   ...
   // caller must release
   if (value)
     value-&gt;<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#2b9f941c8693c281e8683bca97704e4d" title="Internal Only.">release()</a>;
 }
 </pre> </code> 
<p>Definition at line <a class="el" href="RefCounted_8h-source.html#l00084">84</a> of file <a class="el" href="RefCounted_8h-source.html">RefCounted.h</a>.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#395308babb5ac6d276e138c694d1535c">acquire</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal Only.  <a href="#395308babb5ac6d276e138c694d1535c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#2b9f941c8693c281e8683bca97704e4d">release</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal Only.  <a href="#2b9f941c8693c281e8683bca97704e4d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#fb4fffd0e51d88703d57aff0d005cb58">copyReference</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new Java object that refers to the same native object.  <a href="#fb4fffd0e51d88703d57aff0d005cb58"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#392547e13239ce2685f50d50350658aa">getCurrentRefCount</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current reference count on this object.  <a href="#392547e13239ce2685f50d50350658aa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#120cf9de6dd0cfec3cad071f53306002">setJavaAllocator</a> (void *allocator)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method is public but not part of the standard API.  <a href="#120cf9de6dd0cfec3cad071f53306002"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#c72c1232baf8544ee28ee36f882ae12d">getJavaAllocator</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method is public but not part of the standard API.  <a href="#c72c1232baf8544ee28ee36f882ae12d"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#377ee6051c095110ff1032f97768fffa">destroy</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method is called by <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> objects when their Ref Count reaches zero and they are about to be destroyed.  <a href="#377ee6051c095110ff1032f97768fffa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#826830c14cb5668497baa7e46c72f391">RefCounted</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#19d4bdc2f4223f61f65c422fb7d56bdf">~RefCounted</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1AtomicInteger.html">AtomicInteger</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a">mRefCount</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is the internal reference count, represented as an <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1AtomicInteger.html" title="Internal only.">AtomicInteger</a> to make sure it is thread safe.  <a href="#30ad211299dfe337ba7b45a1f72eb39a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944">mAllocator</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Not part of public API.  <a href="#9a03a51e2b143d0f6241f6e7a6fe0944"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="826830c14cb5668497baa7e46c72f391"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::RefCounted" ref="826830c14cb5668497baa7e46c72f391" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">com::xuggle::ferry::RefCounted::RefCounted           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00029">29</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="RefCounted_8h-source.html#l00193">mAllocator</a>, and <a class="el" href="RefCounted_8h-source.html#l00188">mRefCount</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00030"></a>00030   {
<a name="l00031"></a>00031     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a> = <span class="keyword">new</span> AtomicInteger(0);
<a name="l00032"></a>00032     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a> = 0;
<a name="l00033"></a>00033   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="19d4bdc2f4223f61f65c422fb7d56bdf"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::~RefCounted" ref="19d4bdc2f4223f61f65c422fb7d56bdf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">com::xuggle::ferry::RefCounted::~RefCounted           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00035">35</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="RefCounted_8h-source.html#l00193">mAllocator</a>, <a class="el" href="RefCounted_8h-source.html#l00188">mRefCount</a>, and <a class="el" href="JNIHelper_8h-source.html#l00081">com::xuggle::ferry::JNIHelper::sDeleteGlobalRef()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00036"></a>00036   {
<a name="l00037"></a>00037     <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a>)
<a name="l00038"></a>00038       <span class="keyword">delete</span> <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a>;
<a name="l00039"></a>00039     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a> = 0;
<a name="l00040"></a>00040     <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a>)
<a name="l00041"></a>00041       <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIHelper.html#41b6e2e8d525acc825a679ef19cba2e7">JNIHelper::sDeleteGlobalRef</a>((jobject)<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a>);
<a name="l00042"></a>00042     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a> = 0;
<a name="l00043"></a>00043   }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="395308babb5ac6d276e138c694d1535c"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::acquire" ref="395308babb5ac6d276e138c694d1535c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t com::xuggle::ferry::RefCounted::acquire           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal Only. 
<p>
<b>DO NOT USE FROM JAVA</b>. <p>
Acquire a reference to this object. This increments the native internal ref count in native code by +1.  <p>
This method is called internally by Ferry in Java, and you should not call it without knowing what you are doing. But if you do call it, make sure you call <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#2b9f941c8693c281e8683bca97704e4d">release()</a> once for each call you make to this method.  <dl class="return" compact><dt><b>Returns:</b></dt><dd>The refcount after the acquire. Note due to multi-threaded issues, you should not rely on this value, as it may change before the method returns to you. </dd></dl>

<p>Reimplemented in <a class="el" href="classcom_1_1xuggle_1_1xuggler_1_1Codec.html#c88a56a6dffc10fe59e313ff8c584f91">com::xuggle::xuggler::Codec</a>, <a class="el" href="classcom_1_1xuggle_1_1xuggler_1_1Stream.html#79c48faa2ff41edb544ac333a0efe3bf">com::xuggle::xuggler::Stream</a>, and <a class="el" href="classcom_1_1xuggle_1_1xuggler_1_1StreamCoder.html#0131a9f0262286143fe03caf5528f860">com::xuggle::xuggler::StreamCoder</a>.</p>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00063">63</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="AtomicInteger_8cpp-source.html#l00231">com::xuggle::ferry::AtomicInteger::incrementAndGet()</a>, and <a class="el" href="RefCounted_8h-source.html#l00188">mRefCount</a>.</p>

<p>Referenced by <a class="el" href="StreamCoder_8cpp-source.html#l01648">com::xuggle::xuggler::StreamCoder::acquire()</a>, <a class="el" href="Stream_8cpp-source.html#l00199">com::xuggle::xuggler::Stream::acquire()</a>, <a class="el" href="Codec_8cpp-source.html#l00210">com::xuggle::xuggler::Codec::acquire()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00094">copyReference()</a>, <a class="el" href="RefCountedTester_8cpp-source.html#l00037">com::xuggle::ferry::RefCountedTester::make()</a>, and <a class="el" href="Mutex_8cpp-source.html#l00171">com::xuggle::ferry::Mutex::make()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00064"></a>00064   {
<a name="l00065"></a>00065     <span class="comment">//VS_LOG_DEBUG("acquire: %p", this);</span>
<a name="l00066"></a>00066     <span class="keywordflow">return</span> <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a>-&gt;incrementAndGet();
<a name="l00067"></a>00067   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2b9f941c8693c281e8683bca97704e4d"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::release" ref="2b9f941c8693c281e8683bca97704e4d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t com::xuggle::ferry::RefCounted::release           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal Only. 
<p>
<b>DO NOT USE FROM JAVA</b>. <p>
This decrements the native internal ref count by -1; the object is destroyed if its ref count reaches zero.  <p>
This method is called internally by Ferry in Java, and you should not call it without knowing what you are doing. But if you do call it, make sure you had previously called <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#395308babb5ac6d276e138c694d1535c">acquire()</a> once for each call to <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#2b9f941c8693c281e8683bca97704e4d">release()</a> you make.  <dl class="return" compact><dt><b>Returns:</b></dt><dd>The ref count after the release. Note due to multi-threaded issues, you should not rely on this value, as it may change before the method returns to you. </dd></dl>

<p>Reimplemented in <a class="el" href="classcom_1_1xuggle_1_1xuggler_1_1Codec.html#677bcb03560dec61c25d4c328dd7c7b1">com::xuggle::xuggler::Codec</a>, <a class="el" href="classcom_1_1xuggle_1_1xuggler_1_1Stream.html#8eb913e96f5bafbf33a5e4c7358a1ab2">com::xuggle::xuggler::Stream</a>, and <a class="el" href="classcom_1_1xuggle_1_1xuggler_1_1StreamCoder.html#1255b6ea6a270ed2391edcb0eab63c5f">com::xuggle::xuggler::StreamCoder</a>.</p>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00070">70</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="AtomicInteger_8cpp-source.html#l00245">com::xuggle::ferry::AtomicInteger::decrementAndGet()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00086">destroy()</a>, and <a class="el" href="RefCounted_8h-source.html#l00188">mRefCount</a>.</p>

<p>Referenced by <a class="el" href="StreamCoder_8cpp-source.html#l00100">com::xuggle::xuggler::StreamCoder::make()</a>, <a class="el" href="StreamCoder_8cpp-source.html#l01657">com::xuggle::xuggler::StreamCoder::release()</a>, <a class="el" href="Stream_8cpp-source.html#l00208">com::xuggle::xuggler::Stream::release()</a>, <a class="el" href="Codec_8cpp-source.html#l00218">com::xuggle::xuggler::Codec::release()</a>, <a class="el" href="StreamCoder_8cpp-source.html#l00309">com::xuggle::xuggler::StreamCoder::setCodec()</a>, <a class="el" href="Stream_8cpp-source.html#l00348">com::xuggle::xuggler::Stream::setMetaData()</a>, and <a class="el" href="Container_8cpp-source.html#l01118">com::xuggle::xuggler::Container::setMetaData()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00071"></a>00071   {
<a name="l00072"></a>00072     <span class="comment">//VS_LOG_DEBUG("release: %p", this);</span>
<a name="l00073"></a>00073     int32_t retval = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a>-&gt;decrementAndGet();
<a name="l00074"></a>00074     <span class="keywordflow">if</span> (!retval)
<a name="l00075"></a>00075       this-&gt;<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#377ee6051c095110ff1032f97768fffa" title="This method is called by RefCounted objects when their Ref Count reaches zero and...">destroy</a>();
<a name="l00076"></a>00076     <span class="keywordflow">return</span> retval;
<a name="l00077"></a>00077   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fb4fffd0e51d88703d57aff0d005cb58"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::copyReference" ref="fb4fffd0e51d88703d57aff0d005cb58" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a> * com::xuggle::ferry::RefCounted::copyReference           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a new Java object that refers to the same native object. 
<p>
This method is meant for other language use like Java; it will acquire the object but also force the creation of a new proxy object in the target language that just forwards to the same native object. <p>
It is not meant for calling from C++ code; use the standard acquire and release semantics for that.  <dl class="return" compact><dt><b>Returns:</b></dt><dd>A new Java object. </dd></dl>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00094">94</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="RefCounted_8cpp-source.html#l00063">acquire()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00095"></a>00095   {
<a name="l00096"></a>00096     this-&gt;<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#395308babb5ac6d276e138c694d1535c" title="Internal Only.">acquire</a>();
<a name="l00097"></a>00097     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00098"></a>00098   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="392547e13239ce2685f50d50350658aa"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::getCurrentRefCount" ref="392547e13239ce2685f50d50350658aa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t com::xuggle::ferry::RefCounted::getCurrentRefCount           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the current reference count on this object. 
<p>
The number returned represents the value at the instant the message was called, and the value can change even before this method returns. Callers are advised not to depend on the value of this except to check that the value == 1. <p>
If the value returned is one, and you know you have a valid reference to that object, then congratulations; you are the only person referencing that object.  <dl class="return" compact><dt><b>Returns:</b></dt><dd>The current ref count. </dd></dl>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00080">80</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="AtomicInteger_8cpp-source.html#l00144">com::xuggle::ferry::AtomicInteger::get()</a>, and <a class="el" href="RefCounted_8h-source.html#l00188">mRefCount</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00081"></a>00081   {
<a name="l00082"></a>00082     <span class="keywordflow">return</span> <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a" title="This is the internal reference count, represented as an AtomicInteger to make sure...">mRefCount</a>-&gt;get();
<a name="l00083"></a>00083   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="120cf9de6dd0cfec3cad071f53306002"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::setJavaAllocator" ref="120cf9de6dd0cfec3cad071f53306002" args="(void *allocator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com::xuggle::ferry::RefCounted::setJavaAllocator           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>allocator</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This method is public but not part of the standard API. 
<p>
<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> objects can have a Java Allocator associated with them. In general users of this library should NEVER call this method, but it has to be public.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>allocator</em>&nbsp;</td><td>An instance of a jobject we can use to do large memory allocation. The object should be of the com.xuggle.ferry.JNIMemoryAllocator java type. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00046">46</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="RefCounted_8h-source.html#l00193">mAllocator</a>, <a class="el" href="JNIHelper_8h-source.html#l00081">com::xuggle::ferry::JNIHelper::sDeleteGlobalRef()</a>, and <a class="el" href="JNIHelper_8h-source.html#l00077">com::xuggle::ferry::JNIHelper::sNewGlobalRef()</a>.</p>

<p>Referenced by <a class="el" href="JNIMemoryManager_8cpp-source.html#l00733">Java_com_xuggle_ferry_JNIMemoryAllocator_setAllocator()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00047"></a>00047   {
<a name="l00048"></a>00048     <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a>)
<a name="l00049"></a>00049       <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIHelper.html#41b6e2e8d525acc825a679ef19cba2e7">JNIHelper::sDeleteGlobalRef</a>((jobject)<a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a>);
<a name="l00050"></a>00050     <span class="keywordflow">if</span> (allocator)
<a name="l00051"></a>00051       <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a> = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIHelper.html#e9041e796cfcfddf18c04a2a3e8697a3">JNIHelper::sNewGlobalRef</a>((jobject)allocator);
<a name="l00052"></a>00052     <span class="keywordflow">else</span>
<a name="l00053"></a>00053       <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a> = 0;
<a name="l00054"></a>00054   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c72c1232baf8544ee28ee36f882ae12d"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::getJavaAllocator" ref="c72c1232baf8544ee28ee36f882ae12d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * com::xuggle::ferry::RefCounted::getJavaAllocator           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This method is public but not part of the standard API. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Get the java allocator set. </dd></dl>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00057">57</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>References <a class="el" href="RefCounted_8h-source.html#l00193">mAllocator</a>.</p>

<p>Referenced by <a class="el" href="JNIMemoryManager_8cpp-source.html#l00743">Java_com_xuggle_ferry_JNIMemoryAllocator_getAllocator()</a>, and <a class="el" href="Buffer_8cpp-source.html#l00091">com::xuggle::ferry::Buffer::make()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00058"></a>00058   {
<a name="l00059"></a>00059     <span class="keywordflow">return</span> <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944" title="Not part of public API.">mAllocator</a>;
<a name="l00060"></a>00060   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="377ee6051c095110ff1032f97768fffa"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::destroy" ref="377ee6051c095110ff1032f97768fffa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com::xuggle::ferry::RefCounted::destroy           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This method is called by <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects -- it mains reference counts in native code.">RefCounted</a> objects when their Ref Count reaches zero and they are about to be destroyed. 
<p>

<p>Definition at line <a class="el" href="RefCounted_8cpp-source.html#l00086">86</a> of file <a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a>.</p>

<p>Referenced by <a class="el" href="RefCounted_8cpp-source.html#l00070">release()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00087"></a>00087   {
<a name="l00088"></a>00088     <span class="comment">//VS_LOG_DEBUG("destroy: %p", this);</span>
<a name="l00089"></a>00089     <span class="comment">// by default just call the destructor</span>
<a name="l00090"></a>00090     <span class="keyword">delete</span> <span class="keyword">this</span>;
<a name="l00091"></a>00091   }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="30ad211299dfe337ba7b45a1f72eb39a"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::mRefCount" ref="30ad211299dfe337ba7b45a1f72eb39a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1AtomicInteger.html">AtomicInteger</a>* <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#30ad211299dfe337ba7b45a1f72eb39a">com::xuggle::ferry::RefCounted::mRefCount</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This is the internal reference count, represented as an <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1AtomicInteger.html" title="Internal only.">AtomicInteger</a> to make sure it is thread safe. 
<p>

<p>Definition at line <a class="el" href="RefCounted_8h-source.html#l00188">188</a> of file <a class="el" href="RefCounted_8h-source.html">RefCounted.h</a>.</p>

<p>Referenced by <a class="el" href="RefCounted_8cpp-source.html#l00063">acquire()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00080">getCurrentRefCount()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00029">RefCounted()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00070">release()</a>, and <a class="el" href="RefCounted_8cpp-source.html#l00035">~RefCounted()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9a03a51e2b143d0f6241f6e7a6fe0944"></a><!-- doxytag: member="com::xuggle::ferry::RefCounted::mAllocator" ref="9a03a51e2b143d0f6241f6e7a6fe0944" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html#9a03a51e2b143d0f6241f6e7a6fe0944">com::xuggle::ferry::RefCounted::mAllocator</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Not part of public API. 
<p>

<p>Definition at line <a class="el" href="RefCounted_8h-source.html#l00193">193</a> of file <a class="el" href="RefCounted_8h-source.html">RefCounted.h</a>.</p>

<p>Referenced by <a class="el" href="RefCounted_8cpp-source.html#l00057">getJavaAllocator()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00029">RefCounted()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00046">setJavaAllocator()</a>, and <a class="el" href="RefCounted_8cpp-source.html#l00035">~RefCounted()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>csrc/com/xuggle/ferry/<a class="el" href="RefCounted_8h-source.html">RefCounted.h</a><li>csrc/com/xuggle/ferry/<a class="el" href="RefCounted_8cpp-source.html">RefCounted.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jul 11 07:40:05 2011 for Xuggle by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
