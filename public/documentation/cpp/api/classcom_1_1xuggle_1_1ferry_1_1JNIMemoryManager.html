<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Xuggle: com::xuggle::ferry::JNIMemoryManager Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacecom.html">com</a>::<a class="el" href="namespacecom_1_1xuggle.html">xuggle</a>::<a class="el" href="namespacecom_1_1xuggle_1_1ferry.html">ferry</a>::<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html">JNIMemoryManager</a>
  </div>
</div>
<div class="contents">
<h1>com::xuggle::ferry::JNIMemoryManager Class Reference</h1><!-- doxytag: class="com::xuggle::ferry::JNIMemoryManager" --><code>#include &lt;<a class="el" href="JNIMemoryManager_8h-source.html">JNIMemoryManager.h</a>&gt;</code>
<p>

<p>
<a href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
This class's implementation of <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#5be86521981ac184fbc1dfbd04ebd3db" title="Create a malloced block of AT LEAST site_t bounds long.">malloc()</a> and <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#11a7fd2c5545fcd1e5b778104bb60cb4" title="Free memory previously allocated by malloc(void*, size_t).">free()</a> will forward to the standard library's <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#5be86521981ac184fbc1dfbd04ebd3db" title="Create a malloced block of AT LEAST site_t bounds long.">malloc()</a> and <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#11a7fd2c5545fcd1e5b778104bb60cb4" title="Free memory previously allocated by malloc(void*, size_t).">free()</a>, UNLESS you're running in a JVM, in which case it will use Java to manage the memory for us. 
<p>
Use it when you have large memory structures that live for a long time that you want the JVM to resource manage for you, or if you're trying to track down an object in Java that is collecting large objects; this will allow you to tie back big chunks of memory to the misbehaving java object in your code (using a memory profiler like SAP's Eclipse plugin). 
<p>Definition at line <a class="el" href="JNIMemoryManager_8h-source.html#l00051">51</a> of file <a class="el" href="JNIMemoryManager_8h-source.html">JNIMemoryManager.h</a>.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#5be86521981ac184fbc1dfbd04ebd3db">malloc</a> (size_t requested_size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a malloced block of AT LEAST site_t bounds long.  <a href="#5be86521981ac184fbc1dfbd04ebd3db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#11a7fd2c5545fcd1e5b778104bb60cb4">free</a> (void *mem)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free memory previously allocated by <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#a6050387ced5b3972b7b36517469f254" title="Create a malloced block of AT LEAST site_t bounds long by using an allocator.">malloc(void*, size_t)</a>.  <a href="#11a7fd2c5545fcd1e5b778104bb60cb4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#a6050387ced5b3972b7b36517469f254">malloc</a> (void *allocator, size_t requested_size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a malloced block of AT LEAST site_t bounds long by using an allocator.  <a href="#a6050387ced5b3972b7b36517469f254"></a><br></td></tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="5be86521981ac184fbc1dfbd04ebd3db"></a><!-- doxytag: member="com::xuggle::ferry::JNIMemoryManager::malloc" ref="5be86521981ac184fbc1dfbd04ebd3db" args="(size_t requested_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * com::xuggle::ferry::JNIMemoryManager::malloc           </td>
          <td>(</td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>requested_size</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a malloced block of AT LEAST site_t bounds long. 
<p>
This block will be aligned on a 128-bit boundary, suitable for passing to libraries that do SSE-based operations on it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>requested_size</em>&nbsp;</td><td>Requested minimum size of memory, in bytes</td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>std::std_alloc</em>&nbsp;</td><td>If memory cannot be allocated</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a block of memory of at least requested size aligned on a 128-bit boundary. </dd></dl>

<p>Definition at line <a class="el" href="JNIMemoryManager_8cpp-source.html#l00086">86</a> of file <a class="el" href="JNIMemoryManager_8cpp-source.html">JNIMemoryManager.cpp</a>.</p>

<p>Referenced by <a class="el" href="Buffer_8cpp-source.html#l00091">com::xuggle::ferry::Buffer::make()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00087"></a>00087 {
<a name="l00088"></a>00088   <span class="keywordflow">return</span> <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#5be86521981ac184fbc1dfbd04ebd3db" title="Create a malloced block of AT LEAST site_t bounds long.">JNIMemoryManager::malloc</a>(0, requested_size);
<a name="l00089"></a>00089 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="11a7fd2c5545fcd1e5b778104bb60cb4"></a><!-- doxytag: member="com::xuggle::ferry::JNIMemoryManager::free" ref="11a7fd2c5545fcd1e5b778104bb60cb4" args="(void *mem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com::xuggle::ferry::JNIMemoryManager::free           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mem</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free memory previously allocated by <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#a6050387ced5b3972b7b36517469f254" title="Create a malloced block of AT LEAST site_t bounds long by using an allocator.">malloc(void*, size_t)</a>. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mem</em>&nbsp;</td><td>previously allocated by <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#a6050387ced5b3972b7b36517469f254" title="Create a malloced block of AT LEAST site_t bounds long by using an allocator.">malloc(void*, size_t)</a> </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="JNIMemoryManager_8cpp-source.html#l00099">99</a> of file <a class="el" href="JNIMemoryManager_8cpp-source.html">JNIMemoryManager.cpp</a>.</p>

<p>Referenced by <a class="el" href="Buffer_8cpp-source.html#l00091">com::xuggle::ferry::Buffer::make()</a>, and <a class="el" href="Buffer_8cpp-source.html#l00053">com::xuggle::ferry::Buffer::~Buffer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00100"></a>00100 {
<a name="l00101"></a>00101   VSJNI_free(mem);
<a name="l00102"></a>00102 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a6050387ced5b3972b7b36517469f254"></a><!-- doxytag: member="com::xuggle::ferry::JNIMemoryManager::malloc" ref="a6050387ced5b3972b7b36517469f254" args="(void *allocator, size_t requested_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * com::xuggle::ferry::JNIMemoryManager::malloc           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>allocator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>requested_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a malloced block of AT LEAST site_t bounds long by using an allocator. 
<p>
Allocates a block of memory using the passed in allocator. If running inside a JVM, allocator must be a jobject, and must be a subclass of <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html" title="This class&#39;s implementation of malloc() and free() will forward to the standard...">com.xuggle.ferry.JNIMemoryManager</a>. Also you must ensure that allocator lives longer than the block of memory you allocate (i.e. does not get collected by the GC).<p>
This method is useful for Swig proxy objects where you want to fake a reference from the proxy object to memory allocated by the object the proxy objet mallocs. Then, when checked using profiling tools, the native memory will accumulate to the proxy object, which will help you find proxy leaks.<p>
If you are not allocating with the JVM, or we are using JVM Direct Buffers for memory, the allocator object is only used to help print debugging messages.<p>
This block will be aligned on a 128-bit boundary, suitable for passing to libraries that do SSE-based operations on it.<p>
Lastly if you understood or followed any of the above comments you're not drunk enough to work on this code.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>requested_size</em>&nbsp;</td><td>Requested minimum size of memory, in bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>allocator</em>&nbsp;</td><td>Either a jobject as documented above, or 0.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>std::std_alloc</em>&nbsp;</td><td>If memory cannot be allocated </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="JNIMemoryManager_8cpp-source.html#l00092">92</a> of file <a class="el" href="JNIMemoryManager_8cpp-source.html">JNIMemoryManager.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00093"></a>00093 {
<a name="l00094"></a>00094   <span class="keywordtype">void</span> * retval = VSJNI_malloc(static_cast&lt;jobject&gt; (obj), requested_size);
<a name="l00095"></a>00095   <span class="keywordflow">return</span> retval;
<a name="l00096"></a>00096 }
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>csrc/com/xuggle/ferry/<a class="el" href="JNIMemoryManager_8h-source.html">JNIMemoryManager.h</a><li>csrc/com/xuggle/ferry/<a class="el" href="JNIMemoryManager_8cpp-source.html">JNIMemoryManager.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jul 11 07:40:05 2011 for Xuggle by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
