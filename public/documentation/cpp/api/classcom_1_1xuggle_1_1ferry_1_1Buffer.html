<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Xuggle: com::xuggle::ferry::Buffer Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacecom.html">com</a>::<a class="el" href="namespacecom_1_1xuggle.html">xuggle</a>::<a class="el" href="namespacecom_1_1xuggle_1_1ferry.html">ferry</a>::<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a>
  </div>
</div>
<div class="contents">
<h1>com::xuggle::ferry::Buffer Class Reference</h1><!-- doxytag: class="com::xuggle::ferry::Buffer" --><!-- doxytag: inherits="com::xuggle::ferry::IBuffer" --><code>#include &lt;<a class="el" href="Buffer_8h-source.html">Buffer.h</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for com::xuggle::ferry::Buffer:</div>
<div class="dynsection">
<p><center><img src="classcom_1_1xuggle_1_1ferry_1_1Buffer__inherit__graph.png" border="0" usemap="#com_1_1xuggle_1_1ferry_1_1Buffer__inherit__map" alt="Inheritance graph"></center>
<map name="com_1_1xuggle_1_1ferry_1_1Buffer__inherit__map">
<area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html" title="Allows Java code to get data from a native buffers, and optionally modify native..." alt="" coords="21,84,205,111"><area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects &#45;&#45; it mains reference counts in native code." alt="" coords="5,7,221,34"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for com::xuggle::ferry::Buffer:</div>
<div class="dynsection">
<p><center><img src="classcom_1_1xuggle_1_1ferry_1_1Buffer__coll__graph.png" border="0" usemap="#com_1_1xuggle_1_1ferry_1_1Buffer__coll__map" alt="Collaboration graph"></center>
<map name="com_1_1xuggle_1_1ferry_1_1Buffer__coll__map">
<area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html" title="Allows Java code to get data from a native buffers, and optionally modify native..." alt="" coords="29,180,213,206"><area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html" title="Parent of all Ferry objects &#45;&#45; it mains reference counts in native code." alt="" coords="13,100,229,126"><area shape="rect" href="classcom_1_1xuggle_1_1ferry_1_1AtomicInteger.html" title="Internal only." alt="" coords="5,6,237,33"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classcom_1_1xuggle_1_1ferry_1_1Buffer-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="Buffer_8h-source.html#l00028">28</a> of file <a class="el" href="Buffer_8h-source.html">Buffer.h</a>.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#e8141e5b5309c4c831e7de631e9c9819">getBytes</a> (int32_t offset, int32_t length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns up to length bytes, starting at offset in the underlying buffer we're managing.  <a href="#e8141e5b5309c4c831e7de631e9c9819"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#05a156e1f9b30b0cb00373ad0027ea15">getBufferSize</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the current maximum number of bytes that can be safely placed in this buffer.  <a href="#05a156e1f9b30b0cb00373ad0027ea15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#bd7e26951b1133a29472c87b00d7e7b7">getType</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the type this buffer was created as.  <a href="#bd7e26951b1133a29472c87b00d7e7b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#5c1a4e9705c8a70cc8944c4fde3672ff">setType</a> (<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset the buffer type to a new type.  <a href="#5c1a4e9705c8a70cc8944c4fde3672ff"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#a280a71c02afcb9a541a43d7930c463b">getSize</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the size, in units of <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#bd7e26951b1133a29472c87b00d7e7b7">getType()</a> of this buffer.  <a href="#a280a71c02afcb9a541a43d7930c463b"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static VS_API_FERRY <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#8be88d8588508e4b74a2cdd4657dd1c3">make</a> (<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a> *requestor, int32_t bufferSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a new buffer of at least bufferSize.  <a href="#8be88d8588508e4b74a2cdd4657dd1c3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static VS_API_FERRY <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#6609ba59f48aab9f606cc4ede0724907">make</a> (<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a> *requestor, void *bufToWrap, int32_t bufferSize, <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#23854156d2e632726f5759e08f949bcc">FreeFunc</a> freeFunc, void *closure)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create an iBuffer that wraps the given buffer, and calls FreeFunc(buffer, closure) on it when we believe it's safe to destruct it.  <a href="#6609ba59f48aab9f606cc4ede0724907"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#fb104554452907712eda8e4dd4ab1a74">make</a> (<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">com::xuggle::ferry::RefCounted</a> *requestor, <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a> type, int32_t numElements, bool zero)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a new buffer of at least bufferSize.  <a href="#fb104554452907712eda8e4dd4ab1a74"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#12d880c290e1350b9b71c484adbeb9d6">getTypeSize</a> (<a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a> type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the size, in bytes, of elements of given Type.  <a href="#12d880c290e1350b9b71c484adbeb9d6"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#a8ec83c5626181bd308a55230134766a">Buffer</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#593ac29de252273ee4bd3ebf260faabb">~Buffer</a> ()</td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a8ec83c5626181bd308a55230134766a"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::Buffer" ref="a8ec83c5626181bd308a55230134766a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">com::xuggle::ferry::Buffer::Buffer           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00045">45</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="IBuffer_8h-source.html#l00119">com::xuggle::ferry::IBuffer::IBUFFER_UINT8</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00045"></a>00045                    : mBuffer(0), mBufferSize(0)
<a name="l00046"></a>00046   {
<a name="l00047"></a>00047     mFreeFunc = 0;
<a name="l00048"></a>00048     mClosure = 0;
<a name="l00049"></a>00049     mInternallyAllocated = <span class="keyword">false</span>;
<a name="l00050"></a>00050     mType = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa00966ae6be932d0143b8916672af8151a">IBUFFER_UINT8</a>; <span class="comment">// bytes</span>
<a name="l00051"></a>00051   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="593ac29de252273ee4bd3ebf260faabb"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::~Buffer" ref="593ac29de252273ee4bd3ebf260faabb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">com::xuggle::ferry::Buffer::~Buffer           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00053">53</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="JNIMemoryManager_8cpp-source.html#l00099">com::xuggle::ferry::JNIMemoryManager::free()</a>, and <a class="el" href="Logger_8h-source.html#l00207">VS_ASSERT</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00054"></a>00054   {
<a name="l00055"></a>00055     <span class="keywordflow">if</span> (mBuffer)
<a name="l00056"></a>00056     {
<a name="l00057"></a>00057       <a class="code" href="Logger_8h.html#cc63c47c2830d2158599b12926d7daee">VS_ASSERT</a>(mBufferSize, <span class="stringliteral">"had buffer but no size"</span>);
<a name="l00058"></a>00058       <span class="keywordflow">if</span> (mInternallyAllocated)
<a name="l00059"></a>00059         <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#11a7fd2c5545fcd1e5b778104bb60cb4" title="Free memory previously allocated by malloc(void*, size_t).">JNIMemoryManager::free</a>(mBuffer);
<a name="l00060"></a>00060       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mFreeFunc)
<a name="l00061"></a>00061         mFreeFunc(mBuffer, mClosure);
<a name="l00062"></a>00062       mBuffer = 0;
<a name="l00063"></a>00063       mBufferSize = 0;
<a name="l00064"></a>00064       mFreeFunc = 0;
<a name="l00065"></a>00065       mClosure = 0;
<a name="l00066"></a>00066     }
<a name="l00067"></a>00067   }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e8141e5b5309c4c831e7de631e9c9819"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::getBytes" ref="e8141e5b5309c4c831e7de631e9c9819" args="(int32_t offset, int32_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * com::xuggle::ferry::Buffer::getBytes           </td>
          <td>(</td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns up to length bytes, starting at offset in the underlying buffer we're managing. 
<p>
Note that with this method you are accessing the direct memory, so be careful.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>The offset (in bytes) into the buffer managed by this <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html" title="Allows Java code to get data from a native buffers, and optionally modify native...">IBuffer</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The requested length (in bytes) you want to access. The buffer returned may actually be longer than length.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A pointer to the direct buffer, or 0 if the offset or length would not fit within the buffer we're managing. </dd></dl>

<p>Implements <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#1d014bd1ad06d764a0c2fb1b3dcd2d4a">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00071">71</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00072"></a>00072   {
<a name="l00073"></a>00073     <span class="keywordtype">void</span>* retval = 0;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075     <span class="keywordflow">if</span> (length == 0)
<a name="l00076"></a>00076       length = mBufferSize - offset;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keywordflow">if</span> ((length &gt; 0) &amp;&amp; (length + offset &lt;= mBufferSize))
<a name="l00079"></a>00079       retval = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) mBuffer)+offset;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="keywordflow">return</span> retval;
<a name="l00082"></a>00082   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="05a156e1f9b30b0cb00373ad0027ea15"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::getBufferSize" ref="05a156e1f9b30b0cb00373ad0027ea15" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t com::xuggle::ferry::Buffer::getBufferSize           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the current maximum number of bytes that can be safely placed in this buffer. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Maximum number of bytes this buffer can manage. </dd></dl>

<p>Implements <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#a5743da411135fd90cb1c3e99b2cfaa4">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00085">85</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>Referenced by <a class="el" href="Buffer_8cpp-source.html#l00175">getSize()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00086"></a>00086   {
<a name="l00087"></a>00087     <span class="keywordflow">return</span> mBufferSize;
<a name="l00088"></a>00088   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8be88d8588508e4b74a2cdd4657dd1c3"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::make" ref="8be88d8588508e4b74a2cdd4657dd1c3" args="(RefCounted *requestor, int32_t bufferSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a> * com::xuggle::ferry::Buffer::make           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a> *&nbsp;</td>
          <td class="paramname"> <em>requestor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>bufferSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocate a new buffer of at least bufferSize. 
<p>

<p>Reimplemented from <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#2c5cb74b2f3dbf30219b1ad3f78c44a3">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00091">91</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="JNIMemoryManager_8cpp-source.html#l00099">com::xuggle::ferry::JNIMemoryManager::free()</a>, <a class="el" href="RefCounted_8cpp-source.html#l00057">com::xuggle::ferry::RefCounted::getJavaAllocator()</a>, <a class="el" href="JNIMemoryManager_8cpp-source.html#l00086">com::xuggle::ferry::JNIMemoryManager::malloc()</a>, <a class="el" href="Buffer_8h-source.html#l00063">mBuffer</a>, <a class="el" href="Buffer_8h-source.html#l00066">mBufferSize</a>, and <a class="el" href="Buffer_8h-source.html#l00067">mInternallyAllocated</a>.</p>

<p>Referenced by <a class="el" href="Packet_8cpp-source.html#l00307">com::xuggle::xuggler::Packet::allocateNewPayload()</a>, <a class="el" href="IBuffer_8cpp-source.html#l00042">com::xuggle::ferry::IBuffer::make()</a>, and <a class="el" href="Buffer_8cpp-source.html#l00114">make()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00092"></a>00092   {
<a name="l00093"></a>00093     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#a8ec83c5626181bd308a55230134766a">Buffer</a>* retval = 0;
<a name="l00094"></a>00094     <span class="keywordflow">if</span> (bufferSize &lt;= 0)
<a name="l00095"></a>00095       <span class="keywordflow">return</span> 0;
<a name="l00096"></a>00096     
<a name="l00097"></a>00097     <span class="keywordtype">void</span> * allocator = requestor ? requestor-&gt;getJavaAllocator() : 0;
<a name="l00098"></a>00098     <span class="keywordtype">void</span> *buffer = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#5be86521981ac184fbc1dfbd04ebd3db" title="Create a malloced block of AT LEAST site_t bounds long.">JNIMemoryManager::malloc</a>(allocator, bufferSize);
<a name="l00099"></a>00099     <span class="keywordflow">if</span> (!buffer)
<a name="l00100"></a>00100       <span class="keywordflow">return</span> 0;
<a name="l00101"></a>00101       
<a name="l00102"></a>00102     retval = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#8be88d8588508e4b74a2cdd4657dd1c3" title="Allocate a new buffer of at least bufferSize.">Buffer::make</a>();
<a name="l00103"></a>00103     <span class="keywordflow">if</span> (!retval) {
<a name="l00104"></a>00104       <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1JNIMemoryManager.html#11a7fd2c5545fcd1e5b778104bb60cb4" title="Free memory previously allocated by malloc(void*, size_t).">JNIMemoryManager::free</a>(buffer);
<a name="l00105"></a>00105       <span class="keywordflow">return</span> 0;
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107     retval-&gt;mBuffer = buffer; 
<a name="l00108"></a>00108     retval-&gt;mBufferSize = bufferSize;
<a name="l00109"></a>00109     retval-&gt;mInternallyAllocated = <span class="keyword">true</span>;
<a name="l00110"></a>00110     <span class="keywordflow">return</span> retval;
<a name="l00111"></a>00111   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6609ba59f48aab9f606cc4ede0724907"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::make" ref="6609ba59f48aab9f606cc4ede0724907" args="(RefCounted *requestor, void *bufToWrap, int32_t bufferSize, FreeFunc freeFunc, void *closure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a> * com::xuggle::ferry::Buffer::make           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">RefCounted</a> *&nbsp;</td>
          <td class="paramname"> <em>requestor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>bufToWrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>bufferSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#23854156d2e632726f5759e08f949bcc">FreeFunc</a>&nbsp;</td>
          <td class="paramname"> <em>freeFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>closure</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create an iBuffer that wraps the given buffer, and calls FreeFunc(buffer, closure) on it when we believe it's safe to destruct it. 
<p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00114">114</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="Buffer_8cpp-source.html#l00091">make()</a>, <a class="el" href="Buffer_8h-source.html#l00063">mBuffer</a>, <a class="el" href="Buffer_8h-source.html#l00066">mBufferSize</a>, <a class="el" href="Buffer_8h-source.html#l00065">mClosure</a>, <a class="el" href="Buffer_8h-source.html#l00064">mFreeFunc</a>, and <a class="el" href="Buffer_8h-source.html#l00067">mInternallyAllocated</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00116"></a>00116   {
<a name="l00117"></a>00117     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#a8ec83c5626181bd308a55230134766a">Buffer</a> * retval = 0;
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (bufToWrap &amp;&amp; bufferSize&gt;0)
<a name="l00120"></a>00120     {
<a name="l00121"></a>00121       retval = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#8be88d8588508e4b74a2cdd4657dd1c3" title="Allocate a new buffer of at least bufferSize.">Buffer::make</a>();
<a name="l00122"></a>00122       <span class="keywordflow">if</span> (retval)
<a name="l00123"></a>00123       {
<a name="l00124"></a>00124         retval-&gt;mFreeFunc = freeFunc;
<a name="l00125"></a>00125         retval-&gt;mClosure = closure;
<a name="l00126"></a>00126         retval-&gt;mBufferSize = bufferSize;
<a name="l00127"></a>00127         retval-&gt;mBuffer = bufToWrap;
<a name="l00128"></a>00128         retval-&gt;mInternallyAllocated = <span class="keyword">false</span>;
<a name="l00129"></a>00129       }
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131     <span class="keywordflow">return</span> retval;
<a name="l00132"></a>00132   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bd7e26951b1133a29472c87b00d7e7b7"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::getType" ref="bd7e26951b1133a29472c87b00d7e7b7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">IBuffer::Type</a> com::xuggle::ferry::Buffer::getType           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the type this buffer was created as. 
<p>
A type is really just a hint. Like <a class="el" href="">objects</a>, <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html">IBuffer</a> objects can be cast to and from any type.  <dl class="return" compact><dt><b>Returns:</b></dt><dd>the type </dd></dl>

<p>Implements <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#e7f71584eb88302297afef136f2700a2">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00135">135</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00136"></a>00136   {
<a name="l00137"></a>00137     <span class="keywordflow">return</span> mType;
<a name="l00138"></a>00138   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5c1a4e9705c8a70cc8944c4fde3672ff"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::setType" ref="5c1a4e9705c8a70cc8944c4fde3672ff" args="(Type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com::xuggle::ferry::Buffer::setType           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reset the buffer type to a new type. 
<p>
This method does not do any data conversion, it just changes the reported type (so changing from <a class="el" href="">Type#IBUFFER_UINT8</a> to <a class="el" href="">Type#IBUFFER_SINT16</a> is really just a "cast" operation).  <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>the type to set to. </td></tr>
  </table>
</dl>

<p>Implements <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#c093329482ccf0997aa1e12b80ab40ce">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00141">141</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00142"></a>00142   {
<a name="l00143"></a>00143     mType = type;
<a name="l00144"></a>00144   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a280a71c02afcb9a541a43d7930c463b"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::getSize" ref="a280a71c02afcb9a541a43d7930c463b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t com::xuggle::ferry::Buffer::getSize           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the size, in units of <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#bd7e26951b1133a29472c87b00d7e7b7">getType()</a> of this buffer. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>number of items of type <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#bd7e26951b1133a29472c87b00d7e7b7">getType()</a> that will fit in this buffer. </dd></dl>

<p>Implements <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#1b50ab977737e65cb96474ff3f26d70a">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00175">175</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="Buffer_8cpp-source.html#l00085">getBufferSize()</a>, and <a class="el" href="IBuffer_8h-source.html#l00129">com::xuggle::ferry::IBuffer::IBUFFER_NB</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00176"></a>00176   {
<a name="l00177"></a>00177     <span class="keywordflow">if</span> (mType &lt; 0 || mType &gt;= <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0b0b64daf22265799bee467fcc2621378">IBUFFER_NB</a>)
<a name="l00178"></a>00178       <span class="keywordflow">return</span> 0;
<a name="l00179"></a>00179     <span class="keywordflow">return</span> <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#05a156e1f9b30b0cb00373ad0027ea15" title="Get the current maximum number of bytes that can be safely placed in this buffer...">getBufferSize</a>()/mTypeSize[(int32_t)mType];
<a name="l00180"></a>00180   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fb104554452907712eda8e4dd4ab1a74"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::make" ref="fb104554452907712eda8e4dd4ab1a74" args="(com::xuggle::ferry::RefCounted *requestor, Type type, int32_t numElements, bool zero)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html">Buffer</a> * com::xuggle::ferry::Buffer::make           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1RefCounted.html">com::xuggle::ferry::RefCounted</a> *&nbsp;</td>
          <td class="paramname"> <em>requestor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>numElements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>zero</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocate a new buffer of at least bufferSize. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>requestor</em>&nbsp;</td><td>An optional value telling the <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html" title="Allows Java code to get data from a native buffers, and optionally modify native...">IBuffer</a> class what object requested it. This is used for debugging memory leaks; it's a marker for the FERRY object (e.g. IPacket) that actually requested the buffer. If you're not an FERRY object, pass in null here. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>The type of buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numElements</em>&nbsp;</td><td>The minimum number of elements of the specified type you will put in this buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zero</em>&nbsp;</td><td>If true, we will guarantee the buffer contains only zeros. If false, we will not (it is faster to not, but then the buffer will have garbage-data in it).</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A new buffer, or null on error. </dd></dl>

<p>Reimplemented from <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#13dcc7f5f7dffed61ccc4a209c07c405">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00147">147</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="IBuffer_8h-source.html#l00129">com::xuggle::ferry::IBuffer::IBUFFER_NB</a>, and <a class="el" href="Buffer_8cpp-source.html#l00091">make()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00149"></a>00149   {
<a name="l00150"></a>00150     <span class="keywordflow">if</span> (numElements &lt;= 0)
<a name="l00151"></a>00151       <span class="keywordflow">return</span> 0;
<a name="l00152"></a>00152     <span class="keywordflow">if</span> (type &lt; 0 || type &gt;= <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0b0b64daf22265799bee467fcc2621378">IBUFFER_NB</a>)
<a name="l00153"></a>00153       <span class="keywordflow">return</span> 0;
<a name="l00154"></a>00154     
<a name="l00155"></a>00155     int32_t bytesRequested = numElements*mTypeSize[(int32_t)type];
<a name="l00156"></a>00156     <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#a8ec83c5626181bd308a55230134766a">Buffer</a> *retval = <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1Buffer.html#8be88d8588508e4b74a2cdd4657dd1c3" title="Allocate a new buffer of at least bufferSize.">Buffer::make</a>(requestor, bytesRequested);
<a name="l00157"></a>00157     <span class="keywordflow">if</span> (retval)
<a name="l00158"></a>00158     {
<a name="l00159"></a>00159       retval-&gt;mType = type;
<a name="l00160"></a>00160       <span class="keywordflow">if</span> (zero)
<a name="l00161"></a>00161         memset(retval-&gt;getBytes(0, bytesRequested), 0, bytesRequested);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163     <span class="keywordflow">return</span> retval;
<a name="l00164"></a>00164   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="12d880c290e1350b9b71c484adbeb9d6"></a><!-- doxytag: member="com::xuggle::ferry::Buffer::getTypeSize" ref="12d880c290e1350b9b71c484adbeb9d6" args="(Type type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t com::xuggle::ferry::Buffer::getTypeSize           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0">Type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the size, in bytes, of elements of given Type. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the size in bytes. </dd></dl>

<p>Reimplemented from <a class="el" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#d327394c30d14de2a10b57928dd22cbf">com::xuggle::ferry::IBuffer</a>.</p>

<p>Definition at line <a class="el" href="Buffer_8cpp-source.html#l00167">167</a> of file <a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a>.</p>

<p>References <a class="el" href="IBuffer_8h-source.html#l00129">com::xuggle::ferry::IBuffer::IBUFFER_NB</a>.</p>

<p>Referenced by <a class="el" href="IBuffer_8cpp-source.html#l00065">com::xuggle::ferry::IBuffer::getTypeSize()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00168"></a>00168   {
<a name="l00169"></a>00169     <span class="keywordflow">if</span> (type &lt; 0 || type &gt;= <a class="code" href="classcom_1_1xuggle_1_1ferry_1_1IBuffer.html#7967fb91b55662b315a188da65326fa0b0b64daf22265799bee467fcc2621378">IBUFFER_NB</a>)
<a name="l00170"></a>00170       <span class="keywordflow">return</span> 0;
<a name="l00171"></a>00171     <span class="keywordflow">return</span> mTypeSize[(int32_t)type];
<a name="l00172"></a>00172   }
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>csrc/com/xuggle/ferry/<a class="el" href="Buffer_8h-source.html">Buffer.h</a><li>csrc/com/xuggle/ferry/<a class="el" href="Buffer_8cpp-source.html">Buffer.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jul 11 07:40:04 2011 for Xuggle by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
